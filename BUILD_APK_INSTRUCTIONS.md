# üì± –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ APK –¥–ª—è Good Road

## –û–±–∑–æ—Ä

Good Road –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Expo –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å–±–æ—Ä–∫–∏. –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ —Å–æ–∑–¥–∞—Ç—å APK.

---

## –ú–µ—Ç–æ–¥ 1: EAS Build (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**EAS (Expo Application Services)** - –æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å —Å–±–æ—Ä–∫–∏ –æ—Ç Expo.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ –ù–µ –Ω—É–∂–µ–Ω Android Studio –∏–ª–∏ Java
- ‚úÖ –°–±–æ—Ä–∫–∞ –≤ –æ–±–ª–∞–∫–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CI/CD

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ EAS CLI

```bash
cd /app/frontend
npm install -g eas-cli
```

### –®–∞–≥ 2: –í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç Expo

```bash
eas login
# –í–≤–µ–¥–∏—Ç–µ —Å–≤–æ–∏ Expo credentials
```

–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞:
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ https://expo.dev
# –ò–ª–∏ —á–µ—Ä–µ–∑ CLI:
eas register
```

### –®–∞–≥ 3: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è EAS Build (–µ—Å–ª–∏ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)
eas build:configure
```

–§–∞–π–ª `eas.json` —É–∂–µ —Å–æ–∑–¥–∞–Ω —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø—Ä–æ—Ñ–∏–ª—è–º–∏:
- **development** - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å dev client)
- **preview** - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (APK)
- **production** - –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (APK)

### –®–∞–≥ 4: –°–±–æ—Ä–∫–∞ APK

#### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (preview):
```bash
eas build --platform android --profile preview
```

#### –î–ª—è production:
```bash
eas build --platform android --profile production
```

### –®–∞–≥ 5: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ APK

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏ (5-15 –º–∏–Ω—É—Ç):
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://expo.dev/accounts/[–≤–∞—à-username]/projects/good-road/builds
2. –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–π build
3. –ù–∞–∂–º–∏—Ç–µ "Download" —á—Ç–æ–±—ã —Å–∫–∞—á–∞—Ç—å APK
4. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ APK –Ω–∞ Android —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:
```bash
# –ß–µ—Ä–µ–∑ adb
adb install good-road.apk
```

---

## –ú–µ—Ç–æ–¥ 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç Android Studio)

### –ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:
- Android Studio —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- Android SDK –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- Java JDK 17+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd /app/frontend
yarn install
```

### –®–∞–≥ 2: Pre-build (—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)

```bash
npx expo prebuild --platform android
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –ø–∞–ø–∫—É `android/` —Å –Ω–∞—Ç–∏–≤–Ω—ã–º Android –ø—Ä–æ–µ–∫—Ç–æ–º.

### –®–∞–≥ 3: –°–±–æ—Ä–∫–∞ APK

```bash
cd android
./gradlew assembleRelease
```

APK –±—É–¥–µ—Ç –≤ `android/app/build/outputs/apk/release/app-release.apk`

### –®–∞–≥ 4: –ü–æ–¥–ø–∏—Å—å APK (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω—É–∂–Ω–∞ –ø–æ–¥–ø–∏—Å—å:

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ keystore (–æ–¥–∏–Ω —Ä–∞–∑)
keytool -genkey -v -keystore my-release-key.keystore \
  -alias my-key-alias -keyalg RSA -keysize 2048 -validity 10000

# –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ APK
jarsigner -verbose -sigalg SHA256withRSA -digestalg SHA-256 \
  -keystore my-release-key.keystore \
  app-release.apk my-key-alias

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å zipalign
zipalign -v 4 app-release.apk good-road-signed.apk
```

---

## –ú–µ—Ç–æ–¥ 3: Expo Classic Build (–£—Å—Ç–∞—Ä–µ–ª–æ)

‚ö†Ô∏è Expo Classic Build –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ EAS Build.

–ï—Å–ª–∏ –≤—Å–µ –∂–µ –Ω—É–∂–Ω–æ:
```bash
expo build:android -t apk
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### app.json - –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```json
{
  "expo": {
    "name": "Good Road",
    "version": "2.0.0",
    "android": {
      "package": "com.goodroad.app",
      "permissions": [
        "ACCESS_FINE_LOCATION",
        "ACCESS_BACKGROUND_LOCATION",
        "FOREGROUND_SERVICE"
      ]
    },
    "extra": {
      "backendUrl": "https://road-monitor-4.emergent.host"
    }
  }
}
```

### –í–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. **package** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. **version** - –≤–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–ª–∏–∑–µ)
3. **permissions** - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è Android
4. **backendUrl** - URL –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞

---

## –ü—Ä–æ—Ñ–∏–ª–∏ —Å–±–æ—Ä–∫–∏ (eas.json)

### Preview (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
```bash
eas build --platform android --profile preview
```
- –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞
- APK (–∞ –Ω–µ AAB)
- –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

### Production (–¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏)
```bash
eas build --platform android --profile production
```
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞
- APK –∏–ª–∏ AAB (–¥–ª—è Google Play)
- –ì–æ—Ç–æ–≤–æ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –í production —Å–±–æ—Ä–∫–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

```env
EXPO_PUBLIC_BACKEND_URL=https://road-monitor-4.emergent.host
```

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤:
- `app.json` ‚Üí `extra.backendUrl`
- –ò–ª–∏ —á–µ—Ä–µ–∑ `eas.json` ‚Üí `env` —Å–µ–∫—Ü–∏—é

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π

### –ß–µ–∫-–ª–∏—Å—Ç:
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –≤ `app.json` (2.0.0 ‚Üí 2.0.1)
- [ ] Backend URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (production)
- [ ] –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (`yarn install`)
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Expo Go
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞ (`yarn lint`)
- [ ] –ù–µ—Ç TypeScript –æ—à–∏–±–æ–∫ (`yarn tsc`)

---

## –†–∞–∑–º–µ—Ä APK

–¢–∏–ø–∏—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä Good Road APK:
- **Preview:** ~50-70 MB
- **Production:** ~40-60 MB (—Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π)

–î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞:
1. –í–∫–ª—é—á–∏—Ç—å ProGuard (–º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–¥–∞)
2. –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ assets
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å vector icons –≤–º–µ—Å—Ç–æ PNG
4. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ APK

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ APK –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

### –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- [ ] GPS —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–∫–ª—é—á–∞–µ—Ç—Å—è/–≤—ã–∫–ª—é—á–∞–µ—Ç—Å—è
- [ ] –ê—É–¥–∏–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
- [ ] Location permission –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è
- [ ] Background location permission –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è
- [ ] –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

### –ü—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä:
- [ ] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ https://road-monitor-4.emergent.host
- [ ] –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- [ ] –ö–ª–∞—Å—Ç–µ—Ä—ã —Å–æ–∑–¥–∞—é—Ç—Å—è

---

## –ü—É–±–ª–∏–∫–∞—Ü–∏—è

### Google Play Store

1. **–°–æ–∑–¥–∞–π—Ç–µ AAB (–≤–º–µ—Å—Ç–æ APK):**
```bash
eas build --platform android --profile production
# –í—ã–±–µ—Ä–∏—Ç–µ AAB format –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
```

2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤ Google Play Console:**
- https://play.google.com/console
- Create app ‚Üí Upload ‚Üí Add release

3. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:**
- –ù–∞–∑–≤–∞–Ω–∏–µ: Good Road
- –û–ø–∏—Å–∞–Ω–∏–µ: –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–æ—Ä–æ–≥
- –°–∫—Ä–∏–Ω—à–æ—Ç—ã (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –ò–∫–æ–Ω–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

4. **Submit for review**

### Direct Distribution (–±–µ–∑ Google Play)

APK –º–æ–∂–Ω–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –Ω–∞–ø—Ä—è–º—É—é:
- –ß–µ—Ä–µ–∑ –≤–µ–±-—Å–∞–π—Ç
- –ß–µ—Ä–µ–∑ —Ñ–∞–π–ª–æ–æ–±–º–µ–Ω–Ω–∏–∫
- –ß–µ—Ä–µ–∑ QR –∫–æ–¥

‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –≤–∫–ª—é—á–∏—Ç—å "Install from Unknown Sources" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Android.

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

### OTA Updates (Over-The-Air)

–î–ª—è –±—ã—Å—Ç—Ä—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ APK:

```bash
eas update --branch production --message "Fixed audio bug"
```

OTA —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è:
- ‚úÖ JavaScript –∫–æ–¥
- ‚úÖ Assets (–∫–∞—Ä—Ç–∏–Ω–∫–∏, –∑–≤—É–∫–∏)
- ‚ùå Native code (–Ω—É–∂–Ω–∞ –Ω–æ–≤–∞—è —Å–±–æ—Ä–∫–∞)

---

## Troubleshooting

### –û—à–∏–±–∫–∞: "Build failed"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ expo.dev
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `app.json` –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞: "Certificate expired"
- –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π keystore: `eas credentials`

### APK –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–ø–∏—Å—å APK
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤–µ—Ä—Å–∏—è –≤—ã—à–µ —á–µ–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è
- –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à: Settings ‚Üí Apps ‚Üí Good Road ‚Üí Clear Data

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫—Ä–∞—à–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `adb logcat | grep GoodRoad`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ permissions –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ backend URL

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Crashlytics (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Firebase Crashlytics –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫—Ä–∞—à–µ–π:

```bash
npx expo install @react-native-firebase/app @react-native-firebase/crashlytics
```

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `app.json`:
```json
{
  "plugins": [
    "@react-native-firebase/app",
    "@react-native-firebase/crashlytics"
  ]
}
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- üìö Expo Documentation: https://docs.expo.dev/
- üèóÔ∏è EAS Build Guide: https://docs.expo.dev/build/introduction/
- ü§ñ Android Developer: https://developer.android.com/
- üí¨ Expo Discord: https://chat.expo.dev/

---

**–î–∞—Ç–∞:** 7 –¥–µ–∫–∞–±—Ä—è 2024  
**–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** 2.0.0  
**–ö–æ–º–∞–Ω–¥–∞:** Good Road Development
