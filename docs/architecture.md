# Good Road - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

## üèóÔ∏è –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

Good Road –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É, —Å–æ—Å—Ç–æ—è—â—É—é –∏–∑ —Ç—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

1. **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** (React Native / Expo)
2. **Backend API** (FastAPI / Python)
3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** (MongoDB)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Mobile App     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Backend API    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   MongoDB    ‚îÇ
‚îÇ  (React Native) ‚îÇ  HTTP   ‚îÇ   (FastAPI)      ‚îÇ         ‚îÇ              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                              ‚îÇ
       ‚îÇ                              ‚îÇ
       ‚îÇ GPS + Accelerometer          ‚îÇ ML Processing
       ‚îÇ Data Collection              ‚îÇ Clustering
       ‚îÇ                              ‚îÇ
       ‚ñº                              ‚ñº
  [Raw Data]                    [Events/Clusters]
```

## üì± Frontend –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **React Native** 0.81.5
- **Expo SDK** 54
- **TypeScript** 5.9.2
- **Expo Router** 6.0.21 ‚Äî —Ñ–∞–π–ª–æ–≤–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
- **Zustand** 5.0.8 ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```
frontend/
‚îú‚îÄ‚îÄ app/                    # –≠–∫—Ä–∞–Ω—ã (Expo Router)
‚îÇ   ‚îú‚îÄ‚îÄ index.tsx          # –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ settings.tsx       # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ admin.tsx          # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–≤–µ–±-–≤–µ—Ä—Å–∏—è)
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ components/            # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ ObstacleAlert.tsx
‚îÇ   ‚îú‚îÄ‚îÄ ObstacleWarningOverlay.tsx
‚îÇ   ‚îú‚îÄ‚îÄ SoundManager.tsx
‚îÇ   ‚îî‚îÄ‚îÄ SimpleToast.tsx
‚îú‚îÄ‚îÄ services/              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ RawDataCollector.ts      # –°–±–æ—Ä —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ EventDetector.ts         # –î–µ—Ç–µ–∫—Ü–∏—è —Å–æ–±—ã—Ç–∏–π (–∫–ª–∏–µ–Ω—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ ObstacleService.ts       # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π —Å —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ SyncService.ts           # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ BatchOfflineManager.ts   # –û—Ñ–ª–∞–π–Ω —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –±–∞—Ç—á–∏–Ω–≥
‚îÇ   ‚îú‚îÄ‚îÄ CalibrationService.ts    # –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ DynamicAudioAlertService.ts  # –ê—É–¥–∏–æ-–æ–ø–æ–≤–µ—â–µ–Ω–∏—è
‚îú‚îÄ‚îÄ hooks/                 # React Hooks
‚îÇ   ‚îú‚îÄ‚îÄ useObstacleAlerts.ts
‚îÇ   ‚îî‚îÄ‚îÄ useAppStore.ts
‚îî‚îÄ‚îÄ assets/                # –†–µ—Å—É—Ä—Å—ã (–∑–≤—É–∫–∏, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –≤ –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**

   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (GPS, –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä)
   - –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ AsyncStorage
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

2. **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö**

   ```
   GPS Location ‚Üí RawDataCollector ‚Üí –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è (40-50 —Ç–æ—á–µ–∫)
                                     ‚Üì
                              –û—Ç–ø—Ä–∞–≤–∫–∞ –±–∞—Ç—á–∞–º–∏ (–∫–∞–∂–¥—ã–µ 5 —Å–µ–∫)
                                     ‚Üì
                              POST /api/raw-data
   ```

3. **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π**

   ```
   useObstacleAlerts Hook ‚Üí ObstacleService ‚Üí GET /api/warnings/{device_id}
                                                    ‚Üì
                                    –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
                                                    ‚Üì
                                    –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
                                                    ‚Üì
                                    DynamicAudioAlertService ‚Üí –ê—É–¥–∏–æ-–æ–ø–æ–≤–µ—â–µ–Ω–∏–µ
   ```

4. **–§–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Expo Task Manager
   - –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ–Ω–µ
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ

### –ö–ª—é—á–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã

#### RawDataCollector

- –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–∞ (10 Hz)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å GPS –¥–∞–Ω–Ω—ã–º–∏
- –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è (40-50 —Ç–æ—á–µ–∫)
- –û—Ç–ø—Ä–∞–≤–∫–∞ –±–∞—Ç—á–∞–º–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

#### EventDetector (–∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≤–µ—Ä—Å–∏—è)

- –ë–∞–∑–æ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—á–µ–≤–∏–¥–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ñ–ª–∞–π–Ω

#### DynamicAudioAlertService

- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –∏ —Ç–æ–Ω–∞
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏

## üñ•Ô∏è Backend –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **FastAPI** 0.110.1 ‚Äî –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Uvicorn** 0.25.0 ‚Äî ASGI —Å–µ—Ä–≤–µ—Ä
- **Motor** 3.3.1 ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π MongoDB –¥—Ä–∞–π–≤–µ—Ä
- **Pydantic** 2.11.7 ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Jinja2** 3.1.6 ‚Äî —à–∞–±–ª–æ–Ω–∏–∑–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ backend

```
backend/
‚îú‚îÄ‚îÄ server.py              # –ì–ª–∞–≤–Ω—ã–π FastAPI —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ ml_processor.py        # ML –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π
‚îú‚îÄ‚îÄ clustering.py          # –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ admin_api.py           # API –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ templates/             # HTML —à–∞–±–ª–æ–Ω—ã –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
    ‚îú‚îÄ‚îÄ admin_dashboard_v3.html
    ‚îú‚îÄ‚îÄ admin_index.html
    ‚îî‚îÄ‚îÄ ...
```

### –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```
POST /api/raw-data
    ‚Üì
–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Pydantic)
    ‚Üì
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ raw_sensor_data
    ‚Üì
ML Processor (ml_processor.py)
    ‚îú‚îÄ‚îÄ EventClassifier.analyze_data_point()
    ‚îú‚îÄ‚îÄ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–ø–∞ —Å–æ–±—ã—Ç–∏—è
    ‚îú‚îÄ‚îÄ –†–∞—Å—á–µ—Ç severity (1-5)
    ‚îî‚îÄ‚îÄ –†–∞—Å—á–µ—Ç confidence (0-1)
    ‚Üì
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ processed_events
    ‚Üì
Clustering (clustering.py)
    ‚îú‚îÄ‚îÄ –ü–æ–∏—Å–∫ –±–ª–∏–∑–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
    ‚îú‚îÄ‚îÄ –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤ –∫–ª–∞—Å—Ç–µ—Ä—ã
    ‚îî‚îÄ‚îÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ obstacle_clusters
    ‚Üì
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (user_warnings)
    ‚Üì
Response —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

#### ml_processor.py ‚Äî EventClassifier

**–ê–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:**

1. **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**

   - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ magnitude: `sqrt(x¬≤ + y¬≤ + z¬≤)`
   - –†–∞—Å—á–µ—Ç –¥–µ–ª—å—Ç (deltaY, deltaZ) –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏
   - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞—Ü–∏–∏ (variance)

2. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º:**

   - **Pothole**: –≤—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å + —Ä–µ–∑–∫–∏–π —É–¥–∞—Ä (deltaZ > 0.55, deltaY > 0.45)
   - **Speed Bump**: —Å—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å + –ø–ª–∞–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ (deltaZ > 0.45, —Å–∫–æ—Ä–æ—Å—Ç—å 11-65 –∫–º/—á)
   - **Bump**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ Z (deltaZ > 0.35)
   - **Braking**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª—å–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è (deltaY > 0.20)
   - **Vibration**: –≤—ã—Å–æ–∫–∞—è –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å (variance > 0.015)

3. **–†–∞—Å—á–µ—Ç severity (1-5):**
   - Critical: ŒîZ > 0.35
   - High: ŒîZ > 0.30
   - Medium: ŒîZ > 0.25
   - Low: ŒîZ > 0.20
   - Minimal: –æ—Å—Ç–∞–ª—å–Ω—ã–µ

#### clustering.py ‚Äî ObstacleClusterer

**–ê–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:**

1. –ü–æ–∏—Å–∫ –±–ª–∏–∑–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ < 50 –º–µ—Ç—Ä–æ–≤)
2. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø—É –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
3. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞ (—Å—Ä–µ–¥–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
4. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:

   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π (reportCount)
   - –°—Ä–µ–¥–Ω—è—è —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å (severity.average)
   - –î–∏–∞–ø–∞–∑–æ–Ω —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏ (severity.min, severity.max)
   - –°–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ —Å–æ–±—ã—Ç–∏–π

5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞:
   - `active` ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä
   - `verified` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
   - `expired` ‚Äî —É—Å—Ç–∞—Ä–µ–≤—à–∏–π (–ø–æ—Å–ª–µ TTL)

### API Endpoints

#### –ü—É–±–ª–∏—á–Ω—ã–µ API

- `POST /api/raw-data` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `GET /api/warnings/{device_id}` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- `DELETE /api/warnings/{warning_id}` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `GET /health` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞
- `GET /ready` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (MongoDB –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)

#### –ê–¥–º–∏–Ω API

- `GET /api/admin/dashboard/v3` ‚Äî –≥–ª–∞–≤–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- `GET /api/admin/v2/events` ‚Äî —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
- `GET /api/admin/v2/clusters` ‚Äî —Å–ø–∏—Å–æ–∫ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- `PUT /api/admin/editor/clusters/{id}` ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞
- `DELETE /api/admin/editor/clusters/{id}` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞
- `POST /api/admin/editor/clusters/bulk-delete` ‚Äî –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- `GET /api/admin/ml-settings` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ML –ø–æ—Ä–æ–≥–æ–≤

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (MongoDB)

### –°—Ö–µ–º–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π

#### raw_sensor_data

```javascript
{
  _id: ObjectId,
  deviceId: String,
  timestamp: DateTime,
  latitude: Number,
  longitude: Number,
  speed: Number,
  accuracy: Number,
  altitude: Number,
  accelerometer_data: [{
    x: Number,
    y: Number,
    z: Number,
    timestamp: Number
  }],
  created_at: DateTime
}
```

**–ò–Ω–¥–µ–∫—Å—ã:**

- `{deviceId: 1, timestamp: -1}`
- `{created_at: 1}` (TTL –¥–ª—è –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∏)

#### processed_events

```javascript
{
  _id: ObjectId,
  id: String (UUID),
  deviceId: String,
  eventType: String,  // pothole, speed_bump, bump, vibration, braking
  severity: Number,   // 1-5
  confidence: Number, // 0-1
  latitude: Number,
  longitude: Number,
  timestamp: DateTime,
  speed: Number,
  accelerometer_magnitude: Number,
  accelerometer_deltaY: Number,
  accelerometer_deltaZ: Number,
  detection_method: String,  // pattern_analysis, threshold
  created_at: DateTime
}
```

**–ò–Ω–¥–µ–∫—Å—ã:**

- `{deviceId: 1, timestamp: -1}`
- `{eventType: 1, severity: 1}`
- `{latitude: 1, longitude: 1}` (–≥–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π)

#### obstacle_clusters

```javascript
{
  _id: ObjectId,
  clusterId: String (UUID),
  obstacleType: String,
  location: {
    latitude: Number,
    longitude: Number
  },
  reportCount: Number,
  confidence: Number,  // 0-1
  severity: {
    min: Number,
    max: Number,
    average: Number
  },
  status: String,  // active, verified, expired, rejected
  devices: [String],
  event_ids: [String],
  created_at: DateTime,
  updated_at: DateTime,
  lastReported: DateTime,
  expiresAt: DateTime,
  notes: String
}
```

**–ò–Ω–¥–µ–∫—Å—ã:**

- `{status: 1}`
- `{expiresAt: 1}` (TTL)
- `{location.latitude: 1, location.longitude: 1}`

## üîÑ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏

- **Non-blocking I/O** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- **–ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–ª–∏–∫** ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ async/await

```python
# –ü—Ä–∏–º–µ—Ä –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
async def process_raw_data(data: List[RawDataPoint]):
    # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–æ—á–µ–∫
    tasks = [classify_event(point) for point in data]
    events = await asyncio.gather(*tasks)

    # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ –ë–î
    await db.processed_events.insert_many(events)
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢–µ–∫—É—â–∏–µ –º–µ—Ä—ã

- **CORS middleware** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** ‚Äî Pydantic —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤** ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –±–æ–ª—å—à–∏—Ö payloads
- **MongoDB –∏–Ω—ä–µ–∫—Ü–∏–∏** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (Motor)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

- [ ] –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- [ ] Rate limiting –¥–ª—è API endpoints
- [ ] HTTPS/TLS –¥–ª—è –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è deviceId (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Å–ø–∞–º–∞)
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–Ω–æ–º–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## üìä –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

### –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **Backend**: –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å (Uvicorn worker)
- **Database**: –æ–¥–Ω–∞ —Ä–µ–ø–ª–∏–∫–∞ MongoDB

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ backend**

   - –ù–µ—Å–∫–æ–ª—å–∫–æ Uvicorn workers (Gunicorn)
   - Load balancer (Nginx/Traefik)
   - Kubernetes Deployment —Å replicas

2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

   - MongoDB Replica Set
   - Sharding –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
   - Read replicas –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**

   - Redis –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–∞–¥–∏—É—Å

4. **–û—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á**
   - Celery + Redis –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
   - –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –ó–∞–ø—É—Å–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (MongoDB)
docker-compose -f docker-compose.local.yml up -d

# Backend
cd backend && uvicorn server:app --reload

# Frontend
cd frontend && expo start
```

### Production (Kubernetes)

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤ –∏–∑ `k8s/`
- MongoDB Atlas –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- Ingress –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- Health checks –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-20
