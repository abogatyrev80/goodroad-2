# Good Road - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

## üìÅ –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
/app/
‚îú‚îÄ‚îÄ backend/              # FastAPI backend
‚îÇ   ‚îú‚îÄ‚îÄ server.py        # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ ml_processor.py  # ML –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ admin_api.py     # API –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ clustering.py    # –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ templates/       # HTML —à–∞–±–ª–æ–Ω—ã –∞–¥–º–∏–Ω–∫–∏
‚îî‚îÄ‚îÄ frontend/            # React Native (Expo) –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    ‚îú‚îÄ‚îÄ app/             # –≠–∫—Ä–∞–Ω—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ services/        # –°–µ—Ä–≤–∏—Å—ã (—Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –∞–ª–µ—Ä—Ç—ã)
    ‚îî‚îÄ‚îÄ hooks/           # React hooks
```

## üó∫Ô∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 09.12.2025)

### –û—Å–Ω–æ–≤–Ω–æ–π Dashboard
**URL:** `/api/admin/dashboard/v3`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ï–¥–∏–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∫–∞—Ä—Ç–æ–π, —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–§—É–Ω–∫—Ü–∏–∏:**
- üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ —Å–æ–±—ã—Ç–∏–π/–∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- üìä –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏—è–º–∏ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏
- üîç –§–∏–ª—å—Ç—Ä—ã (—Ç–∏–ø, —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å, –ø–æ–∏—Å–∫)
- ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ (–æ–¥–∏–Ω–æ—á–Ω–æ–µ –∏ –º–∞—Å—Å–æ–≤–æ–µ)
- ‚òëÔ∏è –ß–µ–∫–±–æ–∫—Å—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- üìç –ö–Ω–æ–ø–∫–∞ "–ù–∞ –∫–∞—Ä—Ç–µ" –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

**ML –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** `/api/admin/ml-settings`
- –ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ—Ä–æ–≥–æ–≤
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ

**–°–æ–∑–¥–∞–Ω–∏–µ APK:** `/api/admin/apk-guide`
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ APK —á–µ—Ä–µ–∑ Expo
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è eas.json
- –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ–±–ª–∞—á–Ω–æ–π –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–∏

**QR –∫–æ–¥—ã:** `/api/expo-qr`
- QR –∫–æ–¥—ã –¥–ª—è Expo Go
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é

## üîå API Endpoints

### –°–æ–±—ã—Ç–∏—è –∏ –∫–ª–∞—Å—Ç–µ—Ä—ã
- `GET /api/admin/v2/events` - –ü–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è
- `GET /api/admin/v2/clusters` - –ü–æ–ª—É—á–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä—ã
- `GET /api/admin/v2/raw-data` - –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (admin_api.py)
- `PUT /api/admin/editor/events/{id}` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ
- `PUT /api/admin/editor/clusters/{id}` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä
- `DELETE /api/admin/editor/events/{id}` - –£–¥–∞–ª–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ
- `DELETE /api/admin/editor/clusters/{id}` - –£–¥–∞–ª–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä
- `POST /api/admin/editor/events/bulk-delete` - –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- `POST /api/admin/editor/clusters/bulk-delete` - –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

### –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
- `POST /api/raw-data` - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –º–æ–±–∏–ª—å–Ω–æ–≥–æ

## üß† ML –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä (ml_processor.py)

### –ü–æ—Ä–æ–≥–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 08.12.2025)

**–õ–µ–∂–∞—á–∏–π –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏–π:**
- deltaZ: 0.25 (–ø–æ–≤—ã—à–µ–Ω–æ —Å 0.145)
- magnitude: 1.20
- –°–∫–æ—Ä–æ—Å—Ç—å: 2.8-12.5 –º/—Å (10-45 –∫–º/—á)

**–Ø–º–∞:**
- deltaZ: 0.30 (–ø–æ–≤—ã—à–µ–Ω–æ —Å 0.145)
- magnitude: 1.25
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: 12.5 –º/—Å (45 –∫–º/—á)

**–ù–µ—Ä–æ–≤–Ω–æ—Å—Ç—å:**
- deltaZ: 0.20
- magnitude: 1.15

**–í–∏–±—Ä–∞—Ü–∏—è:**
- variance: 0.015
- magnitude: 1.12

### –£—Ä–æ–≤–Ω–∏ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π: ŒîZ > 0.35
- –í—ã—Å–æ–∫–∏–π: ŒîZ > 0.30
- –°—Ä–µ–¥–Ω–∏–π: ŒîZ > 0.25
- –ù–∏–∑–∫–∏–π: ŒîZ > 0.20

## üì± –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω (app/index.tsx)
- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞/–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ GPS
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
- –ê—É–¥–∏–æ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è

### –°–µ—Ä–≤–∏—Å—ã

**RawDataCollector.ts**
- –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–∞ (10 Hz)
- –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (40-50 —Ç–æ—á–µ–∫)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è GPS –∏ –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ –±–∞—Ç—á–∞–º–∏ –ø–æ 5 —Å–µ–∫—É–Ω–¥

**DynamicAudioAlertService.ts**
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∞—É–¥–∏–æ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
- –ß–∞—Å—Ç–æ—Ç–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±–ª–∏–∑–æ—Å—Ç–∏

**ObstacleAlertService.ts**
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π —Å backend
- –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
- –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–æ–≤

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (MongoDB)

### –ö–æ–ª–ª–µ–∫—Ü–∏–∏

**raw_sensor_data**
```javascript
{
  deviceId: String,
  timestamp: DateTime,
  latitude: Number,
  longitude: Number,
  speed: Number,
  accelerometer_data: [{x, y, z, timestamp}],
  created_at: DateTime
}
```

**processed_events**
```javascript
{
  id: String,
  eventType: String, // pothole, bump, speed_bump, vibration, braking
  severity: Number, // 1-5
  confidence: Number, // 0-1
  latitude: Number,
  longitude: Number,
  timestamp: DateTime,
  deviceId: String,
  detection_method: String, // pattern_analysis, threshold
  notes: String
}
```

**obstacle_clusters**
```javascript
{
  clusterId: String,
  obstacleType: String,
  location: {latitude, longitude},
  reportCount: Number,
  confidence: Number,
  severity: {min, max, average},
  status: String, // active, expired, verified
  devices: [String],
  event_ids: [String],
  created_at: DateTime,
  updated_at: DateTime,
  lastReported: DateTime,
  notes: String
}
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Backend (.env)
```
MONGO_URL=mongodb://localhost:27017
```

### Frontend (.env)
```
EXPO_PUBLIC_BACKEND_URL=https://road-monitor-4.emergent.host
EXPO_PACKAGER_PROXY_URL=...
EXPO_PACKAGER_HOSTNAME=...
```

### EAS Build (eas.json)
```json
{
  "build": {
    "preview": {
      "android": {"buildType": "apk"}
    },
    "production": {
      "android": {"buildType": "apk"}
    }
  }
}
```

## üìù –£–¥–∞–ª—ë–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (09.12.2025)

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —É–¥–∞–ª–µ–Ω—ã:
- ‚ùå `/admin/dashboard` (v1)
- ‚ùå `/admin/dashboard/v2` (–∑–∞–º–µ–Ω—ë–Ω –Ω–∞ v3)
- ‚ùå `/admin/data-editor` (–≤—Å—Ç—Ä–æ–µ–Ω –≤ v3)

–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω—ã–π dashboard v3.

## üöÄ –ó–∞–ø—É—Å–∫

### Backend
```bash
cd /app/backend
python3 server.py
# –∏–ª–∏ —á–µ—Ä–µ–∑ supervisor
sudo supervisorctl restart backend
```

### Frontend (development)
```bash
cd /app/frontend
expo start --tunnel
# –∏–ª–∏ —á–µ—Ä–µ–∑ supervisor
sudo supervisorctl restart expo
```

### APK —Å–±–æ—Ä–∫–∞
```bash
cd /app/frontend
eas build --platform android --profile preview
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- Backend –ª–æ–≥–∏: `sudo supervisorctl tail backend`
- Frontend –ª–æ–≥–∏: `sudo supervisorctl tail expo`
- –°—Ç–∞—Ç—É—Å: `sudo supervisorctl status`

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **Admin –ø–∞–Ω–µ–ª—å:** https://road-monitor-4.emergent.host/api/admin
- **Dashboard:** https://road-monitor-4.emergent.host/api/admin/dashboard/v3
- **ML –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** https://road-monitor-4.emergent.host/api/admin/ml-settings
- **APK guide:** https://road-monitor-4.emergent.host/api/admin/apk-guide
