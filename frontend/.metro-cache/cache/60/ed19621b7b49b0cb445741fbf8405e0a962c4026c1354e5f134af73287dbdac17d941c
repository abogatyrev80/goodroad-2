{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":283},"end":{"line":11,"column":69,"index":352}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  /**\n   * AlertSettingsService - Сервис для управления настройками системы предупреждений\n   * \n   * Функции:\n   * - Настройка порога превышения скорости\n   * - Кастомизация текстов предупреждений\n   * - Настройка звуковых тем и интенсивности\n   * - Логика \"умолчания\" при нормальной скорости\n   */\n\n  const DEFAULT_SETTINGS = {\n    speedThresholdExcess: 20,\n    // +20 км/ч сверх рекомендованной\n    alertMode: 'full',\n    recommendedSpeeds: {\n      pothole: 40,\n      speed_bump: 20,\n      bump: 50,\n      vibration: 60,\n      braking: 50\n    },\n    customTexts: {\n      pothole: 'Яма через',\n      speed_bump: 'Лежачий полицейский через',\n      bump: 'Неровность через',\n      vibration: 'Плохое покрытие через',\n      braking: 'Место торможения через'\n    },\n    soundSettings: {\n      voiceEnabled: true,\n      sirenEnabled: true,\n      sirenTheme: 'moderate',\n      sirenIntensity: 0.7,\n      voiceSpeed: 1.0,\n      repeatVoice: false // НЕ повторять\n    },\n    alertDistances: {\n      earlyWarning: 200,\n      mainWarning: 100,\n      urgentWarning: 50\n    }\n  };\n  class AlertSettingsService {\n    settings = DEFAULT_SETTINGS;\n    STORAGE_KEY = '@alert_settings';\n    async initialize() {\n      try {\n        const stored = await AsyncStorage.default.getItem(this.STORAGE_KEY);\n        if (stored) {\n          this.settings = {\n            ...DEFAULT_SETTINGS,\n            ...JSON.parse(stored)\n          };\n        }\n      } catch (error) {\n        console.error('Error loading alert settings:', error);\n      }\n    }\n    async saveSettings(settings) {\n      try {\n        this.settings = {\n          ...this.settings,\n          ...settings\n        };\n        await AsyncStorage.default.setItem(this.STORAGE_KEY, JSON.stringify(this.settings));\n      } catch (error) {\n        console.error('Error saving alert settings:', error);\n      }\n    }\n    getSettings() {\n      return {\n        ...this.settings\n      };\n    }\n\n    /**\n     * Проверяет, нужно ли предупреждать на основе скорости\n     * @returns { shouldAlert, alertLevel } - нужно ли предупреждать и уровень (silent/visual/voice/full)\n     */\n    checkSpeedAlert(obstacleType, currentSpeed) {\n      const recommendedSpeed = this.settings.recommendedSpeeds[obstacleType] || 50;\n      const speedExcess = currentSpeed - recommendedSpeed;\n\n      // Если не превышаем порог - молчим или только визуально\n      if (speedExcess <= this.settings.speedThresholdExcess) {\n        return {\n          shouldAlert: speedExcess > 0,\n          // Предупреждаем если хоть немного превышает\n          alertLevel: 'visual',\n          // Только визуально\n          speedExcess\n        };\n      }\n\n      // Превышаем порог - полное предупреждение\n      return {\n        shouldAlert: true,\n        alertLevel: 'full',\n        speedExcess\n      };\n    }\n\n    /**\n     * Получает текст предупреждения\n     */\n    getAlertText(obstacleType, distance) {\n      const baseText = this.settings.customTexts[obstacleType] || 'Препятствие через';\n      return `${baseText} ${Math.round(distance)} метров`;\n    }\n\n    /**\n     * Определяет нужно ли использовать голос\n     */\n    shouldUseVoice(alertLevel) {\n      if (!this.settings.soundSettings.voiceEnabled) return false;\n      return alertLevel === 'voice' || alertLevel === 'full';\n    }\n\n    /**\n     * Определяет нужно ли использовать сирену\n     */\n    shouldUseSiren(alertLevel) {\n      if (!this.settings.soundSettings.sirenEnabled) return false;\n      return alertLevel === 'full';\n    }\n\n    /**\n     * Получает частоту сирены на основе скорости и расстояния\n     */\n    getSirenFrequency(speedExcess, distance) {\n      const {\n        alertDistances\n      } = this.settings;\n\n      // Базовая частота от расстояния\n      let baseFrequency = 0.5; // Медленная (каждые 2 секунды)\n\n      if (distance < alertDistances.urgentWarning) {\n        baseFrequency = 3.0; // Очень быстрая (3 раза в секунду)\n      } else if (distance < alertDistances.mainWarning) {\n        baseFrequency = 1.0; // Средняя (1 раз в секунду)\n      } else if (distance < alertDistances.earlyWarning) {\n        baseFrequency = 0.5; // Медленная\n      }\n\n      // Увеличиваем частоту при превышении скорости\n      if (speedExcess > 40) {\n        baseFrequency *= 2.0;\n      } else if (speedExcess > 30) {\n        baseFrequency *= 1.5;\n      }\n      return baseFrequency;\n    }\n\n    /**\n     * Получает тему сирены\n     */\n    getSirenTheme() {\n      return this.settings.soundSettings.sirenTheme;\n    }\n\n    /**\n     * Нужно ли повторять голосовое предупреждение\n     */\n    shouldRepeatVoice() {\n      return this.settings.soundSettings.repeatVoice;\n    }\n  }\n  var _default = new AlertSettingsService();\n});","lineCount":189,"map":[[12,2,211,0,"Object"],[12,8,211,0],[12,9,211,0,"defineProperty"],[12,23,211,0],[12,24,211,0,"exports"],[12,31,211,0],[13,4,211,0,"enumerable"],[13,14,211,0],[14,4,211,0,"get"],[14,7,211,0],[14,18,211,0,"get"],[14,19,211,0],[15,6,211,0],[15,13,211,0,"_default"],[15,21,211,0],[16,4,211,0],[17,2,211,0],[18,2,11,0],[18,6,11,0,"_reactNativeAsyncStorageAsyncStorage"],[18,42,11,0],[18,45,11,0,"require"],[18,52,11,0],[18,53,11,0,"_dependencyMap"],[18,67,11,0],[19,2,11,0],[19,6,11,0,"AsyncStorage"],[19,18,11,0],[19,21,11,0,"_interopDefault"],[19,36,11,0],[19,37,11,0,"_reactNativeAsyncStorageAsyncStorage"],[19,73,11,0],[20,2,1,0],[21,0,2,0],[22,0,3,0],[23,0,4,0],[24,0,5,0],[25,0,6,0],[26,0,7,0],[27,0,8,0],[28,0,9,0],[30,2,56,0],[30,8,56,6,"DEFAULT_SETTINGS"],[30,24,56,37],[30,27,56,40],[31,4,57,2,"speedThresholdExcess"],[31,24,57,22],[31,26,57,24],[31,28,57,26],[32,4,57,28],[33,4,58,2,"alertMode"],[33,13,58,11],[33,15,58,13],[33,21,58,19],[34,4,59,2,"recommendedSpeeds"],[34,21,59,19],[34,23,59,21],[35,6,60,4,"pothole"],[35,13,60,11],[35,15,60,13],[35,17,60,15],[36,6,61,4,"speed_bump"],[36,16,61,14],[36,18,61,16],[36,20,61,18],[37,6,62,4,"bump"],[37,10,62,8],[37,12,62,10],[37,14,62,12],[38,6,63,4,"vibration"],[38,15,63,13],[38,17,63,15],[38,19,63,17],[39,6,64,4,"braking"],[39,13,64,11],[39,15,64,13],[40,4,65,2],[40,5,65,3],[41,4,66,2,"customTexts"],[41,15,66,13],[41,17,66,15],[42,6,67,4,"pothole"],[42,13,67,11],[42,15,67,13],[42,26,67,24],[43,6,68,4,"speed_bump"],[43,16,68,14],[43,18,68,16],[43,45,68,43],[44,6,69,4,"bump"],[44,10,69,8],[44,12,69,10],[44,30,69,28],[45,6,70,4,"vibration"],[45,15,70,13],[45,17,70,15],[45,40,70,38],[46,6,71,4,"braking"],[46,13,71,11],[46,15,71,13],[47,4,72,2],[47,5,72,3],[48,4,73,2,"soundSettings"],[48,17,73,15],[48,19,73,17],[49,6,74,4,"voiceEnabled"],[49,18,74,16],[49,20,74,18],[49,24,74,22],[50,6,75,4,"sirenEnabled"],[50,18,75,16],[50,20,75,18],[50,24,75,22],[51,6,76,4,"sirenTheme"],[51,16,76,14],[51,18,76,16],[51,28,76,26],[52,6,77,4,"sirenIntensity"],[52,20,77,18],[52,22,77,20],[52,25,77,23],[53,6,78,4,"voiceSpeed"],[53,16,78,14],[53,18,78,16],[53,21,78,19],[54,6,79,4,"repeatVoice"],[54,17,79,15],[54,19,79,17],[54,24,79,22],[54,25,79,24],[55,4,80,2],[55,5,80,3],[56,4,81,2,"alertDistances"],[56,18,81,16],[56,20,81,18],[57,6,82,4,"earlyWarning"],[57,18,82,16],[57,20,82,18],[57,23,82,21],[58,6,83,4,"mainWarning"],[58,17,83,15],[58,19,83,17],[58,22,83,20],[59,6,84,4,"urgentWarning"],[59,19,84,17],[59,21,84,19],[60,4,85,2],[61,2,86,0],[61,3,86,1],[62,2,88,0],[62,8,88,6,"AlertSettingsService"],[62,28,88,26],[62,29,88,27],[63,4,89,10,"settings"],[63,12,89,18],[63,15,89,36,"DEFAULT_SETTINGS"],[63,31,89,52],[64,4,90,19,"STORAGE_KEY"],[64,15,90,30],[64,18,90,33],[64,35,90,50],[65,4,92,2],[65,10,92,8,"initialize"],[65,20,92,18,"initialize"],[65,21,92,18],[65,23,92,21],[66,6,93,4],[66,10,93,8],[67,8,94,6],[67,14,94,12,"stored"],[67,20,94,18],[67,23,94,21],[67,29,94,27,"AsyncStorage"],[67,41,94,39],[67,42,94,39,"default"],[67,49,94,39],[67,50,94,40,"getItem"],[67,57,94,47],[67,58,94,48],[67,62,94,52],[67,63,94,53,"STORAGE_KEY"],[67,74,94,64],[67,75,94,65],[68,8,95,6],[68,12,95,10,"stored"],[68,18,95,16],[68,20,95,18],[69,10,96,8],[69,14,96,12],[69,15,96,13,"settings"],[69,23,96,21],[69,26,96,24],[70,12,96,26],[70,15,96,29,"DEFAULT_SETTINGS"],[70,31,96,45],[71,12,96,47],[71,15,96,50,"JSON"],[71,19,96,54],[71,20,96,55,"parse"],[71,25,96,60],[71,26,96,61,"stored"],[71,32,96,67],[72,10,96,69],[72,11,96,70],[73,8,97,6],[74,6,98,4],[74,7,98,5],[74,8,98,6],[74,15,98,13,"error"],[74,20,98,18],[74,22,98,20],[75,8,99,6,"console"],[75,15,99,13],[75,16,99,14,"error"],[75,21,99,19],[75,22,99,20],[75,53,99,51],[75,55,99,53,"error"],[75,60,99,58],[75,61,99,59],[76,6,100,4],[77,4,101,2],[78,4,103,2],[78,10,103,8,"saveSettings"],[78,22,103,20,"saveSettings"],[78,23,103,21,"settings"],[78,31,103,53],[78,33,103,55],[79,6,104,4],[79,10,104,8],[80,8,105,6],[80,12,105,10],[80,13,105,11,"settings"],[80,21,105,19],[80,24,105,22],[81,10,105,24],[81,13,105,27],[81,17,105,31],[81,18,105,32,"settings"],[81,26,105,40],[82,10,105,42],[82,13,105,45,"settings"],[83,8,105,54],[83,9,105,55],[84,8,106,6],[84,14,106,12,"AsyncStorage"],[84,26,106,24],[84,27,106,24,"default"],[84,34,106,24],[84,35,106,25,"setItem"],[84,42,106,32],[84,43,106,33],[84,47,106,37],[84,48,106,38,"STORAGE_KEY"],[84,59,106,49],[84,61,106,51,"JSON"],[84,65,106,55],[84,66,106,56,"stringify"],[84,75,106,65],[84,76,106,66],[84,80,106,70],[84,81,106,71,"settings"],[84,89,106,79],[84,90,106,80],[84,91,106,81],[85,6,107,4],[85,7,107,5],[85,8,107,6],[85,15,107,13,"error"],[85,20,107,18],[85,22,107,20],[86,8,108,6,"console"],[86,15,108,13],[86,16,108,14,"error"],[86,21,108,19],[86,22,108,20],[86,52,108,50],[86,54,108,52,"error"],[86,59,108,57],[86,60,108,58],[87,6,109,4],[88,4,110,2],[89,4,112,2,"getSettings"],[89,15,112,13,"getSettings"],[89,16,112,13],[89,18,112,31],[90,6,113,4],[90,13,113,11],[91,8,113,13],[91,11,113,16],[91,15,113,20],[91,16,113,21,"settings"],[92,6,113,30],[92,7,113,31],[93,4,114,2],[95,4,116,2],[96,0,117,0],[97,0,118,0],[98,0,119,0],[99,4,120,2,"checkSpeedAlert"],[99,19,120,17,"checkSpeedAlert"],[99,20,120,18,"obstacleType"],[99,32,120,38],[99,34,120,40,"currentSpeed"],[99,46,120,60],[99,48,124,4],[100,6,125,4],[100,12,125,10,"recommendedSpeed"],[100,28,125,26],[100,31,125,29],[100,35,125,33],[100,36,125,34,"settings"],[100,44,125,42],[100,45,125,43,"recommendedSpeeds"],[100,62,125,60],[100,63,125,61,"obstacleType"],[100,75,125,73],[100,76,125,122],[100,80,125,126],[100,82,125,128],[101,6,126,4],[101,12,126,10,"speedExcess"],[101,23,126,21],[101,26,126,24,"currentSpeed"],[101,38,126,36],[101,41,126,39,"recommendedSpeed"],[101,57,126,55],[103,6,128,4],[104,6,129,4],[104,10,129,8,"speedExcess"],[104,21,129,19],[104,25,129,23],[104,29,129,27],[104,30,129,28,"settings"],[104,38,129,36],[104,39,129,37,"speedThresholdExcess"],[104,59,129,57],[104,61,129,59],[105,8,130,6],[105,15,130,13],[106,10,131,8,"shouldAlert"],[106,21,131,19],[106,23,131,21,"speedExcess"],[106,34,131,32],[106,37,131,35],[106,38,131,36],[107,10,131,38],[108,10,132,8,"alertLevel"],[108,20,132,18],[108,22,132,20],[108,30,132,28],[109,10,132,30],[110,10,133,8,"speedExcess"],[111,8,134,6],[111,9,134,7],[112,6,135,4],[114,6,137,4],[115,6,138,4],[115,13,138,11],[116,8,139,6,"shouldAlert"],[116,19,139,17],[116,21,139,19],[116,25,139,23],[117,8,140,6,"alertLevel"],[117,18,140,16],[117,20,140,18],[117,26,140,24],[118,8,141,6,"speedExcess"],[119,6,142,4],[119,7,142,5],[120,4,143,2],[122,4,145,2],[123,0,146,0],[124,0,147,0],[125,4,148,2,"getAlertText"],[125,16,148,14,"getAlertText"],[125,17,148,15,"obstacleType"],[125,29,148,35],[125,31,148,37,"distance"],[125,39,148,53],[125,41,148,63],[126,6,149,4],[126,12,149,10,"baseText"],[126,20,149,18],[126,23,149,21],[126,27,149,25],[126,28,149,26,"settings"],[126,36,149,34],[126,37,149,35,"customTexts"],[126,48,149,46],[126,49,149,47,"obstacleType"],[126,61,149,59],[126,62,149,102],[126,66,149,106],[126,85,149,125],[127,6,150,4],[127,13,150,11],[127,16,150,14,"baseText"],[127,24,150,22],[127,28,150,26,"Math"],[127,32,150,30],[127,33,150,31,"round"],[127,38,150,36],[127,39,150,37,"distance"],[127,47,150,45],[127,48,150,46],[127,57,150,55],[128,4,151,2],[130,4,153,2],[131,0,154,0],[132,0,155,0],[133,4,156,2,"shouldUseVoice"],[133,18,156,16,"shouldUseVoice"],[133,19,156,17,"alertLevel"],[133,29,156,67],[133,31,156,78],[134,6,157,4],[134,10,157,8],[134,11,157,9],[134,15,157,13],[134,16,157,14,"settings"],[134,24,157,22],[134,25,157,23,"soundSettings"],[134,38,157,36],[134,39,157,37,"voiceEnabled"],[134,51,157,49],[134,53,157,51],[134,60,157,58],[134,65,157,63],[135,6,158,4],[135,13,158,11,"alertLevel"],[135,23,158,21],[135,28,158,26],[135,35,158,33],[135,39,158,37,"alertLevel"],[135,49,158,47],[135,54,158,52],[135,60,158,58],[136,4,159,2],[138,4,161,2],[139,0,162,0],[140,0,163,0],[141,4,164,2,"shouldUseSiren"],[141,18,164,16,"shouldUseSiren"],[141,19,164,17,"alertLevel"],[141,29,164,67],[141,31,164,78],[142,6,165,4],[142,10,165,8],[142,11,165,9],[142,15,165,13],[142,16,165,14,"settings"],[142,24,165,22],[142,25,165,23,"soundSettings"],[142,38,165,36],[142,39,165,37,"sirenEnabled"],[142,51,165,49],[142,53,165,51],[142,60,165,58],[142,65,165,63],[143,6,166,4],[143,13,166,11,"alertLevel"],[143,23,166,21],[143,28,166,26],[143,34,166,32],[144,4,167,2],[146,4,169,2],[147,0,170,0],[148,0,171,0],[149,4,172,2,"getSirenFrequency"],[149,21,172,19,"getSirenFrequency"],[149,22,172,20,"speedExcess"],[149,33,172,39],[149,35,172,41,"distance"],[149,43,172,57],[149,45,172,67],[150,6,173,4],[150,12,173,10],[151,8,173,12,"alertDistances"],[152,6,173,27],[152,7,173,28],[152,10,173,31],[152,14,173,35],[152,15,173,36,"settings"],[152,23,173,44],[154,6,175,4],[155,6,176,4],[155,10,176,8,"baseFrequency"],[155,23,176,21],[155,26,176,24],[155,29,176,27],[155,30,176,28],[155,31,176,29],[157,6,178,4],[157,10,178,8,"distance"],[157,18,178,16],[157,21,178,19,"alertDistances"],[157,35,178,33],[157,36,178,34,"urgentWarning"],[157,49,178,47],[157,51,178,49],[158,8,179,6,"baseFrequency"],[158,21,179,19],[158,24,179,22],[158,27,179,25],[158,28,179,26],[158,29,179,27],[159,6,180,4],[159,7,180,5],[159,13,180,11],[159,17,180,15,"distance"],[159,25,180,23],[159,28,180,26,"alertDistances"],[159,42,180,40],[159,43,180,41,"mainWarning"],[159,54,180,52],[159,56,180,54],[160,8,181,6,"baseFrequency"],[160,21,181,19],[160,24,181,22],[160,27,181,25],[160,28,181,26],[160,29,181,27],[161,6,182,4],[161,7,182,5],[161,13,182,11],[161,17,182,15,"distance"],[161,25,182,23],[161,28,182,26,"alertDistances"],[161,42,182,40],[161,43,182,41,"earlyWarning"],[161,55,182,53],[161,57,182,55],[162,8,183,6,"baseFrequency"],[162,21,183,19],[162,24,183,22],[162,27,183,25],[162,28,183,26],[162,29,183,27],[163,6,184,4],[165,6,186,4],[166,6,187,4],[166,10,187,8,"speedExcess"],[166,21,187,19],[166,24,187,22],[166,26,187,24],[166,28,187,26],[167,8,188,6,"baseFrequency"],[167,21,188,19],[167,25,188,23],[167,28,188,26],[168,6,189,4],[168,7,189,5],[168,13,189,11],[168,17,189,15,"speedExcess"],[168,28,189,26],[168,31,189,29],[168,33,189,31],[168,35,189,33],[169,8,190,6,"baseFrequency"],[169,21,190,19],[169,25,190,23],[169,28,190,26],[170,6,191,4],[171,6,193,4],[171,13,193,11,"baseFrequency"],[171,26,193,24],[172,4,194,2],[174,4,196,2],[175,0,197,0],[176,0,198,0],[177,4,199,2,"getSirenTheme"],[177,17,199,15,"getSirenTheme"],[177,18,199,15],[177,20,199,52],[178,6,200,4],[178,13,200,11],[178,17,200,15],[178,18,200,16,"settings"],[178,26,200,24],[178,27,200,25,"soundSettings"],[178,40,200,38],[178,41,200,39,"sirenTheme"],[178,51,200,49],[179,4,201,2],[181,4,203,2],[182,0,204,0],[183,0,205,0],[184,4,206,2,"shouldRepeatVoice"],[184,21,206,19,"shouldRepeatVoice"],[184,22,206,19],[184,24,206,31],[185,6,207,4],[185,13,207,11],[185,17,207,15],[185,18,207,16,"settings"],[185,26,207,24],[185,27,207,25,"soundSettings"],[185,40,207,38],[185,41,207,39,"repeatVoice"],[185,52,207,50],[186,4,208,2],[187,2,209,0],[188,2,211,0],[188,6,211,0,"_default"],[188,14,211,0],[188,17,211,15],[188,21,211,19,"AlertSettingsService"],[188,41,211,39],[188,42,211,40],[188,43,211,41],[189,0,211,42],[189,3]],"functionMap":{"names":["<global>","AlertSettingsService","initialize","saveSettings","getSettings","checkSpeedAlert","getAlertText","shouldUseVoice","shouldUseSiren","getSirenFrequency","getSirenTheme","shouldRepeatVoice"],"mappings":"AAA;ACuF;ECI;GDS;EEE;GFO;EGE;GHE;EIM;GJuB;EKK;GLG;EMK;GNG;EOK;GPG;EQK;GRsB;ESK;GTE;EUK;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}