{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":283},"end":{"line":11,"column":69,"index":352}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  /**\n   * AlertSettingsService - Сервис для управления настройками системы предупреждений\n   * \n   * Функции:\n   * - Настройка порога превышения скорости\n   * - Кастомизация текстов предупреждений\n   * - Настройка звуковых тем и интенсивности\n   * - Логика \"умолчания\" при нормальной скорости\n   */\n\n  const DEFAULT_SETTINGS = {\n    speedThresholdExcess: 20,\n    // +20 км/ч сверх рекомендованной\n    alertMode: 'full',\n    recommendedSpeeds: {\n      pothole: 40,\n      speed_bump: 20,\n      bump: 50,\n      vibration: 60,\n      braking: 50\n    },\n    customTexts: {\n      pothole: 'Яма через',\n      speed_bump: 'Лежачий полицейский через',\n      bump: 'Неровность через',\n      vibration: 'Плохое покрытие через',\n      braking: 'Место торможения через'\n    },\n    soundSettings: {\n      voiceEnabled: true,\n      sirenEnabled: true,\n      sirenTheme: 'moderate',\n      sirenIntensity: 0.7,\n      voiceSpeed: 1.0,\n      repeatVoice: false // НЕ повторять\n    },\n    alertDistances: {\n      earlyWarning: 200,\n      mainWarning: 100,\n      urgentWarning: 50\n    }\n  };\n  class AlertSettingsService {\n    settings = DEFAULT_SETTINGS;\n    STORAGE_KEY = '@alert_settings';\n    async initialize() {\n      try {\n        const stored = await AsyncStorage.default.getItem(this.STORAGE_KEY);\n        if (stored) {\n          this.settings = Object.assign({}, DEFAULT_SETTINGS, JSON.parse(stored));\n        }\n      } catch (error) {\n        console.error('Error loading alert settings:', error);\n      }\n    }\n    async saveSettings(settings) {\n      try {\n        this.settings = Object.assign({}, this.settings, settings);\n        await AsyncStorage.default.setItem(this.STORAGE_KEY, JSON.stringify(this.settings));\n      } catch (error) {\n        console.error('Error saving alert settings:', error);\n      }\n    }\n    getSettings() {\n      return Object.assign({}, this.settings);\n    }\n\n    /**\n     * Проверяет, нужно ли предупреждать на основе скорости\n     * @returns { shouldAlert, alertLevel } - нужно ли предупреждать и уровень (silent/visual/voice/full)\n     */\n    checkSpeedAlert(obstacleType, currentSpeed) {\n      const recommendedSpeed = this.settings.recommendedSpeeds[obstacleType] || 50;\n      const speedExcess = currentSpeed - recommendedSpeed;\n\n      // Если не превышаем порог - молчим или только визуально\n      if (speedExcess <= this.settings.speedThresholdExcess) {\n        return {\n          shouldAlert: speedExcess > 0,\n          // Предупреждаем если хоть немного превышает\n          alertLevel: 'visual',\n          // Только визуально\n          speedExcess\n        };\n      }\n\n      // Превышаем порог - полное предупреждение\n      return {\n        shouldAlert: true,\n        alertLevel: 'full',\n        speedExcess\n      };\n    }\n\n    /**\n     * Получает текст предупреждения\n     */\n    getAlertText(obstacleType, distance) {\n      const baseText = this.settings.customTexts[obstacleType] || 'Препятствие через';\n      return `${baseText} ${Math.round(distance)} метров`;\n    }\n\n    /**\n     * Определяет нужно ли использовать голос\n     */\n    shouldUseVoice(alertLevel) {\n      if (!this.settings.soundSettings.voiceEnabled) return false;\n      return alertLevel === 'voice' || alertLevel === 'full';\n    }\n\n    /**\n     * Определяет нужно ли использовать сирену\n     */\n    shouldUseSiren(alertLevel) {\n      if (!this.settings.soundSettings.sirenEnabled) return false;\n      return alertLevel === 'full';\n    }\n\n    /**\n     * Получает частоту сирены на основе скорости и расстояния\n     */\n    getSirenFrequency(speedExcess, distance) {\n      const {\n        alertDistances\n      } = this.settings;\n\n      // Базовая частота от расстояния\n      let baseFrequency = 0.5; // Медленная (каждые 2 секунды)\n\n      if (distance < alertDistances.urgentWarning) {\n        baseFrequency = 3.0; // Очень быстрая (3 раза в секунду)\n      } else if (distance < alertDistances.mainWarning) {\n        baseFrequency = 1.0; // Средняя (1 раз в секунду)\n      } else if (distance < alertDistances.earlyWarning) {\n        baseFrequency = 0.5; // Медленная\n      }\n\n      // Увеличиваем частоту при превышении скорости\n      if (speedExcess > 40) {\n        baseFrequency *= 2.0;\n      } else if (speedExcess > 30) {\n        baseFrequency *= 1.5;\n      }\n      return baseFrequency;\n    }\n\n    /**\n     * Получает тему сирены\n     */\n    getSirenTheme() {\n      return this.settings.soundSettings.sirenTheme;\n    }\n\n    /**\n     * Нужно ли повторять голосовое предупреждение\n     */\n    shouldRepeatVoice() {\n      return this.settings.soundSettings.repeatVoice;\n    }\n  }\n  var _default = new AlertSettingsService();\n});","lineCount":181,"map":[[12,2,211,0,"Object"],[12,8,211,0],[12,9,211,0,"defineProperty"],[12,23,211,0],[12,24,211,0,"exports"],[12,31,211,0],[13,4,211,0,"enumerable"],[13,14,211,0],[14,4,211,0,"get"],[14,7,211,0],[14,18,211,0,"get"],[14,19,211,0],[15,6,211,0],[15,13,211,0,"_default"],[15,21,211,0],[16,4,211,0],[17,2,211,0],[18,2,11,0],[18,6,11,0,"_reactNativeAsyncStorageAsyncStorage"],[18,42,11,0],[18,45,11,0,"require"],[18,52,11,0],[18,53,11,0,"_dependencyMap"],[18,67,11,0],[19,2,11,0],[19,6,11,0,"AsyncStorage"],[19,18,11,0],[19,21,11,0,"_interopDefault"],[19,36,11,0],[19,37,11,0,"_reactNativeAsyncStorageAsyncStorage"],[19,73,11,0],[20,2,1,0],[21,0,2,0],[22,0,3,0],[23,0,4,0],[24,0,5,0],[25,0,6,0],[26,0,7,0],[27,0,8,0],[28,0,9,0],[30,2,56,0],[30,8,56,6,"DEFAULT_SETTINGS"],[30,24,56,37],[30,27,56,40],[31,4,57,2,"speedThresholdExcess"],[31,24,57,22],[31,26,57,24],[31,28,57,26],[32,4,57,28],[33,4,58,2,"alertMode"],[33,13,58,11],[33,15,58,13],[33,21,58,19],[34,4,59,2,"recommendedSpeeds"],[34,21,59,19],[34,23,59,21],[35,6,60,4,"pothole"],[35,13,60,11],[35,15,60,13],[35,17,60,15],[36,6,61,4,"speed_bump"],[36,16,61,14],[36,18,61,16],[36,20,61,18],[37,6,62,4,"bump"],[37,10,62,8],[37,12,62,10],[37,14,62,12],[38,6,63,4,"vibration"],[38,15,63,13],[38,17,63,15],[38,19,63,17],[39,6,64,4,"braking"],[39,13,64,11],[39,15,64,13],[40,4,65,2],[40,5,65,3],[41,4,66,2,"customTexts"],[41,15,66,13],[41,17,66,15],[42,6,67,4,"pothole"],[42,13,67,11],[42,15,67,13],[42,26,67,24],[43,6,68,4,"speed_bump"],[43,16,68,14],[43,18,68,16],[43,45,68,43],[44,6,69,4,"bump"],[44,10,69,8],[44,12,69,10],[44,30,69,28],[45,6,70,4,"vibration"],[45,15,70,13],[45,17,70,15],[45,40,70,38],[46,6,71,4,"braking"],[46,13,71,11],[46,15,71,13],[47,4,72,2],[47,5,72,3],[48,4,73,2,"soundSettings"],[48,17,73,15],[48,19,73,17],[49,6,74,4,"voiceEnabled"],[49,18,74,16],[49,20,74,18],[49,24,74,22],[50,6,75,4,"sirenEnabled"],[50,18,75,16],[50,20,75,18],[50,24,75,22],[51,6,76,4,"sirenTheme"],[51,16,76,14],[51,18,76,16],[51,28,76,26],[52,6,77,4,"sirenIntensity"],[52,20,77,18],[52,22,77,20],[52,25,77,23],[53,6,78,4,"voiceSpeed"],[53,16,78,14],[53,18,78,16],[53,21,78,19],[54,6,79,4,"repeatVoice"],[54,17,79,15],[54,19,79,17],[54,24,79,22],[54,25,79,24],[55,4,80,2],[55,5,80,3],[56,4,81,2,"alertDistances"],[56,18,81,16],[56,20,81,18],[57,6,82,4,"earlyWarning"],[57,18,82,16],[57,20,82,18],[57,23,82,21],[58,6,83,4,"mainWarning"],[58,17,83,15],[58,19,83,17],[58,22,83,20],[59,6,84,4,"urgentWarning"],[59,19,84,17],[59,21,84,19],[60,4,85,2],[61,2,86,0],[61,3,86,1],[62,2,88,0],[62,8,88,6,"AlertSettingsService"],[62,28,88,26],[62,29,88,27],[63,4,89,10,"settings"],[63,12,89,18],[63,15,89,36,"DEFAULT_SETTINGS"],[63,31,89,52],[64,4,90,19,"STORAGE_KEY"],[64,15,90,30],[64,18,90,33],[64,35,90,50],[65,4,92,2],[65,10,92,8,"initialize"],[65,20,92,18,"initialize"],[65,21,92,18],[65,23,92,21],[66,6,93,4],[66,10,93,8],[67,8,94,6],[67,14,94,12,"stored"],[67,20,94,18],[67,23,94,21],[67,29,94,27,"AsyncStorage"],[67,41,94,39],[67,42,94,39,"default"],[67,49,94,39],[67,50,94,40,"getItem"],[67,57,94,47],[67,58,94,48],[67,62,94,52],[67,63,94,53,"STORAGE_KEY"],[67,74,94,64],[67,75,94,65],[68,8,95,6],[68,12,95,10,"stored"],[68,18,95,16],[68,20,95,18],[69,10,96,8],[69,14,96,12],[69,15,96,13,"settings"],[69,23,96,21],[69,26,96,21,"Object"],[69,32,96,21],[69,33,96,21,"assign"],[69,39,96,21],[69,44,96,29,"DEFAULT_SETTINGS"],[69,60,96,45],[69,62,96,50,"JSON"],[69,66,96,54],[69,67,96,55,"parse"],[69,72,96,60],[69,73,96,61,"stored"],[69,79,96,67],[69,80,96,68],[69,81,96,70],[70,8,97,6],[71,6,98,4],[71,7,98,5],[71,8,98,6],[71,15,98,13,"error"],[71,20,98,18],[71,22,98,20],[72,8,99,6,"console"],[72,15,99,13],[72,16,99,14,"error"],[72,21,99,19],[72,22,99,20],[72,53,99,51],[72,55,99,53,"error"],[72,60,99,58],[72,61,99,59],[73,6,100,4],[74,4,101,2],[75,4,103,2],[75,10,103,8,"saveSettings"],[75,22,103,20,"saveSettings"],[75,23,103,21,"settings"],[75,31,103,53],[75,33,103,55],[76,6,104,4],[76,10,104,8],[77,8,105,6],[77,12,105,10],[77,13,105,11,"settings"],[77,21,105,19],[77,24,105,19,"Object"],[77,30,105,19],[77,31,105,19,"assign"],[77,37,105,19],[77,42,105,27],[77,46,105,31],[77,47,105,32,"settings"],[77,55,105,40],[77,57,105,45,"settings"],[77,65,105,53],[77,66,105,55],[78,8,106,6],[78,14,106,12,"AsyncStorage"],[78,26,106,24],[78,27,106,24,"default"],[78,34,106,24],[78,35,106,25,"setItem"],[78,42,106,32],[78,43,106,33],[78,47,106,37],[78,48,106,38,"STORAGE_KEY"],[78,59,106,49],[78,61,106,51,"JSON"],[78,65,106,55],[78,66,106,56,"stringify"],[78,75,106,65],[78,76,106,66],[78,80,106,70],[78,81,106,71,"settings"],[78,89,106,79],[78,90,106,80],[78,91,106,81],[79,6,107,4],[79,7,107,5],[79,8,107,6],[79,15,107,13,"error"],[79,20,107,18],[79,22,107,20],[80,8,108,6,"console"],[80,15,108,13],[80,16,108,14,"error"],[80,21,108,19],[80,22,108,20],[80,52,108,50],[80,54,108,52,"error"],[80,59,108,57],[80,60,108,58],[81,6,109,4],[82,4,110,2],[83,4,112,2,"getSettings"],[83,15,112,13,"getSettings"],[83,16,112,13],[83,18,112,31],[84,6,113,4],[84,13,113,4,"Object"],[84,19,113,4],[84,20,113,4,"assign"],[84,26,113,4],[84,31,113,16],[84,35,113,20],[84,36,113,21,"settings"],[84,44,113,29],[85,4,114,2],[87,4,116,2],[88,0,117,0],[89,0,118,0],[90,0,119,0],[91,4,120,2,"checkSpeedAlert"],[91,19,120,17,"checkSpeedAlert"],[91,20,120,18,"obstacleType"],[91,32,120,38],[91,34,120,40,"currentSpeed"],[91,46,120,60],[91,48,124,4],[92,6,125,4],[92,12,125,10,"recommendedSpeed"],[92,28,125,26],[92,31,125,29],[92,35,125,33],[92,36,125,34,"settings"],[92,44,125,42],[92,45,125,43,"recommendedSpeeds"],[92,62,125,60],[92,63,125,61,"obstacleType"],[92,75,125,73],[92,76,125,122],[92,80,125,126],[92,82,125,128],[93,6,126,4],[93,12,126,10,"speedExcess"],[93,23,126,21],[93,26,126,24,"currentSpeed"],[93,38,126,36],[93,41,126,39,"recommendedSpeed"],[93,57,126,55],[95,6,128,4],[96,6,129,4],[96,10,129,8,"speedExcess"],[96,21,129,19],[96,25,129,23],[96,29,129,27],[96,30,129,28,"settings"],[96,38,129,36],[96,39,129,37,"speedThresholdExcess"],[96,59,129,57],[96,61,129,59],[97,8,130,6],[97,15,130,13],[98,10,131,8,"shouldAlert"],[98,21,131,19],[98,23,131,21,"speedExcess"],[98,34,131,32],[98,37,131,35],[98,38,131,36],[99,10,131,38],[100,10,132,8,"alertLevel"],[100,20,132,18],[100,22,132,20],[100,30,132,28],[101,10,132,30],[102,10,133,8,"speedExcess"],[103,8,134,6],[103,9,134,7],[104,6,135,4],[106,6,137,4],[107,6,138,4],[107,13,138,11],[108,8,139,6,"shouldAlert"],[108,19,139,17],[108,21,139,19],[108,25,139,23],[109,8,140,6,"alertLevel"],[109,18,140,16],[109,20,140,18],[109,26,140,24],[110,8,141,6,"speedExcess"],[111,6,142,4],[111,7,142,5],[112,4,143,2],[114,4,145,2],[115,0,146,0],[116,0,147,0],[117,4,148,2,"getAlertText"],[117,16,148,14,"getAlertText"],[117,17,148,15,"obstacleType"],[117,29,148,35],[117,31,148,37,"distance"],[117,39,148,53],[117,41,148,63],[118,6,149,4],[118,12,149,10,"baseText"],[118,20,149,18],[118,23,149,21],[118,27,149,25],[118,28,149,26,"settings"],[118,36,149,34],[118,37,149,35,"customTexts"],[118,48,149,46],[118,49,149,47,"obstacleType"],[118,61,149,59],[118,62,149,102],[118,66,149,106],[118,85,149,125],[119,6,150,4],[119,13,150,11],[119,16,150,14,"baseText"],[119,24,150,22],[119,28,150,26,"Math"],[119,32,150,30],[119,33,150,31,"round"],[119,38,150,36],[119,39,150,37,"distance"],[119,47,150,45],[119,48,150,46],[119,57,150,55],[120,4,151,2],[122,4,153,2],[123,0,154,0],[124,0,155,0],[125,4,156,2,"shouldUseVoice"],[125,18,156,16,"shouldUseVoice"],[125,19,156,17,"alertLevel"],[125,29,156,67],[125,31,156,78],[126,6,157,4],[126,10,157,8],[126,11,157,9],[126,15,157,13],[126,16,157,14,"settings"],[126,24,157,22],[126,25,157,23,"soundSettings"],[126,38,157,36],[126,39,157,37,"voiceEnabled"],[126,51,157,49],[126,53,157,51],[126,60,157,58],[126,65,157,63],[127,6,158,4],[127,13,158,11,"alertLevel"],[127,23,158,21],[127,28,158,26],[127,35,158,33],[127,39,158,37,"alertLevel"],[127,49,158,47],[127,54,158,52],[127,60,158,58],[128,4,159,2],[130,4,161,2],[131,0,162,0],[132,0,163,0],[133,4,164,2,"shouldUseSiren"],[133,18,164,16,"shouldUseSiren"],[133,19,164,17,"alertLevel"],[133,29,164,67],[133,31,164,78],[134,6,165,4],[134,10,165,8],[134,11,165,9],[134,15,165,13],[134,16,165,14,"settings"],[134,24,165,22],[134,25,165,23,"soundSettings"],[134,38,165,36],[134,39,165,37,"sirenEnabled"],[134,51,165,49],[134,53,165,51],[134,60,165,58],[134,65,165,63],[135,6,166,4],[135,13,166,11,"alertLevel"],[135,23,166,21],[135,28,166,26],[135,34,166,32],[136,4,167,2],[138,4,169,2],[139,0,170,0],[140,0,171,0],[141,4,172,2,"getSirenFrequency"],[141,21,172,19,"getSirenFrequency"],[141,22,172,20,"speedExcess"],[141,33,172,39],[141,35,172,41,"distance"],[141,43,172,57],[141,45,172,67],[142,6,173,4],[142,12,173,10],[143,8,173,12,"alertDistances"],[144,6,173,27],[144,7,173,28],[144,10,173,31],[144,14,173,35],[144,15,173,36,"settings"],[144,23,173,44],[146,6,175,4],[147,6,176,4],[147,10,176,8,"baseFrequency"],[147,23,176,21],[147,26,176,24],[147,29,176,27],[147,30,176,28],[147,31,176,29],[149,6,178,4],[149,10,178,8,"distance"],[149,18,178,16],[149,21,178,19,"alertDistances"],[149,35,178,33],[149,36,178,34,"urgentWarning"],[149,49,178,47],[149,51,178,49],[150,8,179,6,"baseFrequency"],[150,21,179,19],[150,24,179,22],[150,27,179,25],[150,28,179,26],[150,29,179,27],[151,6,180,4],[151,7,180,5],[151,13,180,11],[151,17,180,15,"distance"],[151,25,180,23],[151,28,180,26,"alertDistances"],[151,42,180,40],[151,43,180,41,"mainWarning"],[151,54,180,52],[151,56,180,54],[152,8,181,6,"baseFrequency"],[152,21,181,19],[152,24,181,22],[152,27,181,25],[152,28,181,26],[152,29,181,27],[153,6,182,4],[153,7,182,5],[153,13,182,11],[153,17,182,15,"distance"],[153,25,182,23],[153,28,182,26,"alertDistances"],[153,42,182,40],[153,43,182,41,"earlyWarning"],[153,55,182,53],[153,57,182,55],[154,8,183,6,"baseFrequency"],[154,21,183,19],[154,24,183,22],[154,27,183,25],[154,28,183,26],[154,29,183,27],[155,6,184,4],[157,6,186,4],[158,6,187,4],[158,10,187,8,"speedExcess"],[158,21,187,19],[158,24,187,22],[158,26,187,24],[158,28,187,26],[159,8,188,6,"baseFrequency"],[159,21,188,19],[159,25,188,23],[159,28,188,26],[160,6,189,4],[160,7,189,5],[160,13,189,11],[160,17,189,15,"speedExcess"],[160,28,189,26],[160,31,189,29],[160,33,189,31],[160,35,189,33],[161,8,190,6,"baseFrequency"],[161,21,190,19],[161,25,190,23],[161,28,190,26],[162,6,191,4],[163,6,193,4],[163,13,193,11,"baseFrequency"],[163,26,193,24],[164,4,194,2],[166,4,196,2],[167,0,197,0],[168,0,198,0],[169,4,199,2,"getSirenTheme"],[169,17,199,15,"getSirenTheme"],[169,18,199,15],[169,20,199,52],[170,6,200,4],[170,13,200,11],[170,17,200,15],[170,18,200,16,"settings"],[170,26,200,24],[170,27,200,25,"soundSettings"],[170,40,200,38],[170,41,200,39,"sirenTheme"],[170,51,200,49],[171,4,201,2],[173,4,203,2],[174,0,204,0],[175,0,205,0],[176,4,206,2,"shouldRepeatVoice"],[176,21,206,19,"shouldRepeatVoice"],[176,22,206,19],[176,24,206,31],[177,6,207,4],[177,13,207,11],[177,17,207,15],[177,18,207,16,"settings"],[177,26,207,24],[177,27,207,25,"soundSettings"],[177,40,207,38],[177,41,207,39,"repeatVoice"],[177,52,207,50],[178,4,208,2],[179,2,209,0],[180,2,211,0],[180,6,211,0,"_default"],[180,14,211,0],[180,17,211,15],[180,21,211,19,"AlertSettingsService"],[180,41,211,39],[180,42,211,40],[180,43,211,41],[181,0,211,42],[181,3]],"functionMap":{"names":["<global>","AlertSettingsService","initialize","saveSettings","getSettings","checkSpeedAlert","getAlertText","shouldUseVoice","shouldUseSiren","getSirenFrequency","getSirenTheme","shouldRepeatVoice"],"mappings":"AAA;ACuF;ECI;GDS;EEE;GFO;EGE;GHE;EIM;GJuB;EKK;GLG;EMK;GNG;EOK;GPG;EQK;GRsB;ESK;GTE;EUK;GVE;CDC"},"hasCjsExports":false},"type":"js/module"}]}